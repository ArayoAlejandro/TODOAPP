<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-16" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Todo APP</title>
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 105 100%22><text y=%22.9em%22 font-size=%2290%22>âš¡</text></svg>">
</head>

<body>
  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>
  <script>

    window.onload = function () {
      const body = document.body
      const bodyMarginLeft = document.defaultView.getComputedStyle(body, "").getPropertyValue("margin-left").split("px")[0]
      const nav = document.querySelector("nav")
      const menuBackDrop = document.querySelector(".bg")

      let leftActive
      let widthActual
      let activeElement

      nav.childNodes.forEach((element) => {
        element.addEventListener("mouseenter", (e) => {

          const element = e.target.children[0]
          const { left, top, width, height } = element.getBoundingClientRect()

          if (activeElement !== element && activeElement !== undefined) {
            activeElement.style.color = "#2e3440"
          }

          element.style.color = "#fff"

          menuBackDrop.style.setProperty("--left", `${left - bodyMarginLeft}px`)
          menuBackDrop.style.setProperty("--top", `${0}px`)
          menuBackDrop.style.setProperty("--width", `${width}px`)
          menuBackDrop.style.setProperty("--height", `${height}px`)
          menuBackDrop.style.setProperty("--width", `${width}px`)
        })

        element.addEventListener("click", (e) => {
          const { left, width } = e.target.getBoundingClientRect()
          activeElement = e.target
          e.target.style.color = "white"
          leftActive = left
          widthActual = width
        })

        element.addEventListener("mouseleave", (e) => {

          const element = e.target.children[0]

          if (activeElement !== element && activeElement !== undefined) {
            activeElement.style.color = "#fff"
          }

          if (activeElement === element) {
            element.style.color = "#fff"
          } else {
            element.style.color = "#2e3440"
          }
        })
      })

      nav.addEventListener("mouseleave", (e) => {
        menuBackDrop.style.setProperty("--left", `${leftActive - bodyMarginLeft}px`)
        menuBackDrop.style.setProperty("--width", `${widthActual}px`)
      })
    }
    
    document.body.addEventListener('keydown', (event) => {
      if (event.key === "Enter" && (event.metaKey || event.ctrlKey)) {
        const form = event.target.form.children
        form.item(form.length - 1).click()
      }
    });
  </script>
</body>

</html>